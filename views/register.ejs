<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <%- include('layouts/links' )%>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Verify</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
            integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
        <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
        <link href="lib/lightbox/css/lightbox.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
            crossorigin="anonymous"></script>
        <style>
            #succes {
                width: 400px;
                margin: auto;
            }

            .form_main {
                width: 280px;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                background-color: rgb(255, 255, 255);
                padding: 30px 30px 30px 30px;
                border-radius: 30px;
                box-shadow: 0px 0px 40px rgba(0, 0, 0, 0.062);
                margin: auto;
                margin-top: 40px;
            }

            .heading {
                font-size: 2.5em;
                color: #2e2e2e;
                font-weight: 700;
                margin: 15px 0 30px 0;
            }

            .inputContainer {
                width: 100%;
                position: relative;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .inputIcon {
                position: absolute;
                left: 10px;
            }

            .inputField {
                width: 100%;
                height: 40px;
                background-color: transparent;
                border: none;
                border-bottom: 2px solid rgb(173, 173, 173);
                border-radius: 30px;
                margin: 10px 0;
                color: black;
                font-size: .8em;
                font-weight: 500;
                box-sizing: border-box;
                padding-left: 30px;
            }

            .inputField:focus {
                outline: none;
                border-bottom: 2px solid #ed7399;
            }

            .inputField::placeholder {
                color: rgb(80, 80, 80);
                font-size: 1em;
                font-weight: 500;
            }

            #button {
                position: relative;
                width: 100%;
                border: 2px solid #F195B2;
                background-color: #F195B2;
                height: 40px;
                color: white;
                font-size: .8em;
                font-weight: 500;
                letter-spacing: 1px;
                border-radius: 30px;
                margin: 10px;
                cursor: pointer;
                overflow: hidden;
            }

            #button::after {
                content: "";
                position: absolute;
                background-color: rgba(255, 255, 255, 0.253);
                height: 100%;
                width: 150px;
                top: 0;
                left: -200px;
                border-bottom-right-radius: 100px;
                border-top-left-radius: 100px;
                filter: blur(10px);
                transition-duration: .5s;
            }

            #button:hover::after {
                transform: translateX(600px);
                transition-duration: .5s;
            }

            .signupContainer {
                margin: 0;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                gap: 20px;
            }

            .signupContainer p {
                font-size: .9em;
                font-weight: 500;
                color: black;
            }

            .signupContainer a {
                font-size: .7em;
                font-weight: 500;
                background-color: #2e2e2e;
                color: white;
                text-decoration: none;
                padding: 8px 15px;
                border-radius: 20px;
            }

            span {
                color: red;
                font-size: 12px;
            }
        </style>
</head>

<body>
    <%- include('layouts/flash' )%>
        <form class="form_main" method="post" action="/register">
            <p class="heading">Register</p>

            <div class="inputContainer">
                <svg viewBox="0 0 16 16" fill="#2e2e2e" height="16" width="16" xmlns="http://www.w3.org/2000/svg"
                    class="inputIcon">
                    <path
                        d="M13.106 7.222c0-2.967-2.249-5.032-5.482-5.032-3.35 0-5.646 2.318-5.646 5.702 0 3.493 2.235 5.708 5.762 5.708.862 0 1.689-.123 2.304-.335v-.862c-.43.199-1.354.328-2.29.328-2.926 0-4.813-1.88-4.813-4.798 0-2.844 1.921-4.881 4.594-4.881 2.735 0 4.608 1.688 4.608 4.156 0 1.682-.554 2.769-1.416 2.769-.492 0-.772-.28-.772-.76V5.206H8.923v.834h-.11c-.266-.595-.881-.964-1.6-.964-1.4 0-2.378 1.162-2.378 2.823 0 1.737.957 2.906 2.379 2.906.8 0 1.415-.39 1.709-1.087h.11c.081.67.703 1.148 1.503 1.148 1.572 0 2.57-1.415 2.57-3.643zm-7.177.704c0-1.197.54-1.907 1.456-1.907.93 0 1.524.738 1.524 1.907S8.308 9.84 7.371 9.84c-.895 0-1.442-.725-1.442-1.914z">
                    </path>
                </svg>
                <input placeholder="firstname" id="firstname" name="firstname" class="inputField" type="text"
                    required><br>
                <span id="spanfirstname" hidden></span>

            </div>
            <div class="inputContainer">
                <svg viewBox="0 0 16 16" fill="#2e2e2e" height="16" width="16" xmlns="http://www.w3.org/2000/svg"
                    class="inputIcon">
                    <path
                        d="M13.106 7.222c0-2.967-2.249-5.032-5.482-5.032-3.35 0-5.646 2.318-5.646 5.702 0 3.493 2.235 5.708 5.762 5.708.862 0 1.689-.123 2.304-.335v-.862c-.43.199-1.354.328-2.29.328-2.926 0-4.813-1.88-4.813-4.798 0-2.844 1.921-4.881 4.594-4.881 2.735 0 4.608 1.688 4.608 4.156 0 1.682-.554 2.769-1.416 2.769-.492 0-.772-.28-.772-.76V5.206H8.923v.834h-.11c-.266-.595-.881-.964-1.6-.964-1.4 0-2.378 1.162-2.378 2.823 0 1.737.957 2.906 2.379 2.906.8 0 1.415-.39 1.709-1.087h.11c.081.67.703 1.148 1.503 1.148 1.572 0 2.57-1.415 2.57-3.643zm-7.177.704c0-1.197.54-1.907 1.456-1.907.93 0 1.524.738 1.524 1.907S8.308 9.84 7.371 9.84c-.895 0-1.442-.725-1.442-1.914z">
                    </path>
                </svg>
                <input placeholder="lastname" id="lastname" name="lastname" class="inputField" type="text"
                    required><span id="spanlastname" hidden></span>
            </div>
            <div class="inputContainer">
                <svg viewBox="0 0 16 16" fill="#2e2e2e" height="16" width="16" xmlns="http://www.w3.org/2000/svg"
                    class="inputIcon">
                    <path
                        d="M13.106 7.222c0-2.967-2.249-5.032-5.482-5.032-3.35 0-5.646 2.318-5.646 5.702 0 3.493 2.235 5.708 5.762 5.708.862 0 1.689-.123 2.304-.335v-.862c-.43.199-1.354.328-2.29.328-2.926 0-4.813-1.88-4.813-4.798 0-2.844 1.921-4.881 4.594-4.881 2.735 0 4.608 1.688 4.608 4.156 0 1.682-.554 2.769-1.416 2.769-.492 0-.772-.28-.772-.76V5.206H8.923v.834h-.11c-.266-.595-.881-.964-1.6-.964-1.4 0-2.378 1.162-2.378 2.823 0 1.737.957 2.906 2.379 2.906.8 0 1.415-.39 1.709-1.087h.11c.081.67.703 1.148 1.503 1.148 1.572 0 2.57-1.415 2.57-3.643zm-7.177.704c0-1.197.54-1.907 1.456-1.907.93 0 1.524.738 1.524 1.907S8.308 9.84 7.371 9.84c-.895 0-1.442-.725-1.442-1.914z">
                    </path>
                </svg>
                <input placeholder="username" id="username" name="username" class="inputField" type="text" required>
                <span id="spanusername" hidden></span>
            </div>
            <div class="inputContainer">
                <svg viewBox="0 0 16 16" fill="#2e2e2e" height="16" width="16" xmlns="http://www.w3.org/2000/svg"
                    class="inputIcon">
                    <path
                        d="M13.106 7.222c0-2.967-2.249-5.032-5.482-5.032-3.35 0-5.646 2.318-5.646 5.702 0 3.493 2.235 5.708 5.762 5.708.862 0 1.689-.123 2.304-.335v-.862c-.43.199-1.354.328-2.29.328-2.926 0-4.813-1.88-4.813-4.798 0-2.844 1.921-4.881 4.594-4.881 2.735 0 4.608 1.688 4.608 4.156 0 1.682-.554 2.769-1.416 2.769-.492 0-.772-.28-.772-.76V5.206H8.923v.834h-.11c-.266-.595-.881-.964-1.6-.964-1.4 0-2.378 1.162-2.378 2.823 0 1.737.957 2.906 2.379 2.906.8 0 1.415-.39 1.709-1.087h.11c.081.67.703 1.148 1.503 1.148 1.572 0 2.57-1.415 2.57-3.643zm-7.177.704c0-1.197.54-1.907 1.456-1.907.93 0 1.524.738 1.524 1.907S8.308 9.84 7.371 9.84c-.895 0-1.442-.725-1.442-1.914z">
                    </path>
                </svg>
                <input placeholder="Phonenumber:/05/06/07" id="Phone" name="Phone" class="inputField" type="text"
                    inputmode="numeric" required><span id="spannumber" hidden></span>

            </div>
            <div class="inputContainer">
                <svg viewBox="0 0 16 16" fill="#2e2e2e" height="16" width="16" xmlns="http://www.w3.org/2000/svg"
                    class="inputIcon">
                    <path
                        d="M13.106 7.222c0-2.967-2.249-5.032-5.482-5.032-3.35 0-5.646 2.318-5.646 5.702 0 3.493 2.235 5.708 5.762 5.708.862 0 1.689-.123 2.304-.335v-.862c-.43.199-1.354.328-2.29.328-2.926 0-4.813-1.88-4.813-4.798 0-2.844 1.921-4.881 4.594-4.881 2.735 0 4.608 1.688 4.608 4.156 0 1.682-.554 2.769-1.416 2.769-.492 0-.772-.28-.772-.76V5.206H8.923v.834h-.11c-.266-.595-.881-.964-1.6-.964-1.4 0-2.378 1.162-2.378 2.823 0 1.737.957 2.906 2.379 2.906.8 0 1.415-.39 1.709-1.087h.11c.081.67.703 1.148 1.503 1.148 1.572 0 2.57-1.415 2.57-3.643zm-7.177.704c0-1.197.54-1.907 1.456-1.907.93 0 1.524.738 1.524 1.907S8.308 9.84 7.371 9.84c-.895 0-1.442-.725-1.442-1.914z">
                    </path>
                </svg>
                <input placeholder="email" id="email" name="email" class="inputField" type="text" required><span
                    id="spanmail" hidden></span>
            </div>
            <div class="inputContainer">
                <svg viewBox="0 0 16 16" fill="#2e2e2e" height="16" width="16" xmlns="http://www.w3.org/2000/svg"
                    class="inputIcon">
                    <path
                        d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z">
                    </path>
                </svg>
                <input placeholder="Password" id="password" class="inputField" name="password" type="password"
                    required><span id="spanpwd" hidden></span>
            </div>


            <button id="button" type="submit">Register</button>
            <div class="signupContainer">
                <p>Already have any account?</p>
                <a href="/Login">Login</a>
            </div>
        </form>
</body>

</html>
<script>
    const firstname = document.getElementById("firstname");
    const lastname = document.getElementById("lastname");
    const username = document.getElementById("username");
    const usedusernames = "<%= users%>";
    const usedemails = "<%= mails %>";
    const email = document.getElementById("email");
    const password = document.getElementById("password");
    const Phonenumber = document.getElementById("Phone");
    const submitbutton = document.getElementById("button");
    const usernamePattern = /^[a-zA-Z0-9_]{8,}$/;
    const phoneNumberPattern = /^(05|06|07)\d{8}$/;
    const namePattern = /^[A-Za-z\s]+$/;
    const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
    const passwordPattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d!@#$%^&*()_+{}\[\]:;<>,.?~\\/-]{8,}$/;
    console.log(submitbutton)
    submitbutton.disabled = true;
    const firstnamestate = false;
    const lastnamestate = false;
    const Phonenumberstate = false;
    const emailstate = false;
    const usernamestate = false;
    const passwordstate = false;
    const validateName = function (input, spanid, patterdused, errormessage, currentstate) {
        const enteredValue = input.value.trim();

        const span = document.getElementById(spanid)

        if (enteredValue.length > 0) {
            if (input.id === "username" && usedusernames.includes(enteredValue)) {
                span.textContent = "Already used username"
                span.hidden = false
                currentstate = false
            }
            else if (input.id === "email" && usedemails.includes(enteredValue)) {
                span.textContent = "Already used email"
                span.hidden = false
                currentstate = false
            }
            else if (!patterdused.test(enteredValue)) {
                span.textContent = errormessage;
                currentstate = false
                span.hidden = false;
            }
            else {
                span.hidden = true
                currentstate = true
            }


        }
        else {
            span.hidden = true
            currentstate = false
        }
    };
    const buttonstatus = function () {
        if (namePattern.test(firstname.value.trim()) && namePattern.test(lastname.value.trim()) &&
            phoneNumberPattern.test(Phonenumber.value.trim()) && emailPattern.test(email.value.trim()) &&
            usernamePattern.test(username.value.trim()) && passwordPattern.test(password.value.trim())) {
            submitbutton.disabled = false;
        }
        else {
            submitbutton.disabled = true;
        }
    }
    firstname.addEventListener("input", function () {
        validateName(firstname, "spanfirstname", namePattern, "Only letters are allowed to be used", firstnamestate);
        buttonstatus();
    });
    lastname.addEventListener("input", function () {
        validateName(lastname, "spanlastname", namePattern, "Only letters are allowed to be used", lastnamestate);
        buttonstatus();

    })
    Phonenumber.addEventListener("input", function () {
        validateName(Phonenumber, "spannumber", phoneNumberPattern, "Invalid phone number format", Phonenumberstate);
        buttonstatus();
    })
    email.addEventListener("input", function () {
        validateName(email, "spanmail", emailPattern, "Not the correct form of a mail", emailstate);
        buttonstatus();
    })
    username.addEventListener("input", function () {
        validateName(username, "spanusername", usernamePattern, "Username should not contain not allowed caracters and  be at least 8 caracters and  ", usernamestate)
        buttonstatus();
    });
    password.addEventListener('input', function () {
        validateName(password, "spanpwd", passwordPattern, "password required atleast one lowercase,uppercase and a number ", passwordstate);
        buttonstatus();

    })



</script>